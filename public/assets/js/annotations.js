(function(a,b,c){function d(a){var b={},e=/^jQuery\d+$/;c.each(a.attributes,function(a,c){c.specified&&!e.test(c.name)&&(b[c.name]=c.value)});return b}function g(a,n){var e=c(this);if(this.value==e.attr("placeholder")&&e.hasClass("placeholder"))if(e.data("placeholder-password")){e=e.hide().next().show().attr("id",e.removeAttr("id").data("placeholder-id"));if(!0===a)return e[0].value=n;e.focus()}else this.value="",e.removeClass("placeholder"),this==b.activeElement&&this.select()}function h(){var a,
b=c(this),e=this.id;if(""==this.value){if("password"==this.type){if(!b.data("placeholder-textinput")){try{a=b.clone().attr({type:"text"})}catch(f){a=c("<input>").attr(c.extend(d(this),{type:"text"}))}a.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":e}).bind("focus.placeholder",g);b.data({"placeholder-textinput":a,"placeholder-id":e}).before(a)}b=b.removeAttr("id").hide().prev().attr("id",e).show()}b.addClass("placeholder");b[0].value=b.attr("placeholder")}else b.removeClass("placeholder")}
var l="placeholder"in b.createElement("input"),k="placeholder"in b.createElement("textarea"),f=c.fn,m=c.valHooks;l&&k?(f=f.placeholder=function(){return this},f.input=f.textarea=!0):(f=f.placeholder=function(){this.filter((l?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":g,"blur.placeholder":h}).data("placeholder-enabled",!0).trigger("blur.placeholder");return this},f.input=l,f.textarea=k,f={get:function(a){var b=c(a);return b.data("placeholder-enabled")&&b.hasClass("placeholder")?
"":a.value},set:function(a,d){var e=c(a);if(!e.data("placeholder-enabled"))return a.value=d;""==d?(a.value=d,a!=b.activeElement&&h.call(a)):e.hasClass("placeholder")?g.call(a,!0,d)||(a.value=d):a.value=d;return e}},l||(m.input=f),k||(m.textarea=f),c(function(){c(b).delegate("form","submit.placeholder",function(){var a=c(".placeholder",this).each(g);setTimeout(function(){a.each(h)},10)})}),c(a).bind("beforeunload.placeholder",function(){c(".placeholder").each(function(){this.value=""})}))})(this,document,
jQuery);
(function(a){function b(){a(".note").hover(function(){a(".notep").hide();a(".note").show();var b=a(this).offset(),d=a(this).height(),g=a("img").height();b.top+d>=g-g/4?(d=a(this).next(".notep").height(),d=b.top-d-10,0<=d?a(this).next(".notep").removeClass("").addClass("bottom").show().css("top",""+d+"px").css("z-index",1E4):a(this).next(".notep").removeClass("").addClass("misc").show().css("top","28px").css("z-index",1E4)):a(this).next(".notep").removeClass("").show().css("z-index",1E4);d=a("img").width();
d-=d/5;g=b.left-(a(this).next(".notep").width()-a(this).width())+12;b.left+a(this).width()>=d&&a(this).next(".notep").removeClass("").addClass("right").css("left","auto").css("left",""+g+"px")},function(){a(".note").show();a(this).next(".notep").hide();a(this).next(".notep").css("z-index",0)})}a.fn.imgNotes=function(c){void 0!=c&&(notes=c);image=this;imgOffset=a(image).offset();a(notes).each(function(){note_left=parseInt(imgOffset.left)+parseInt(this.x1);note_top=parseInt(imgOffset.top)+parseInt(this.y1);
note_p_top=note_top+parseInt(this.height)+10;note_area_div=a("<"+this.edit+" class='note "+this.selected+"'></a>").css({left:note_left+"px",top:note_top+"px",width:this.width+"px",height:this.height+"px"});note_text_div=a('<div class="notep" >'+this.note+"</div>").css({left:note_left+"px",top:note_p_top+"px"});a("body").append(note_area_div);a("body").append(note_text_div)});a(image).hover(function(){a(".note").show()},function(){a(".note").hide()});b()}})(jQuery);
$(window).load(function(){window.scrollTo(0,0);$("input, textarea").placeholder();$("img").imgNotes();$("#cancelnote").click(function(){$("img").imgAreaSelect({hide:!0});$("#noteform").fadeOut(200)});$("#addnotelink").click(function(a){a.preventDefault();a=$(window).scrollTop()+50;var b=$("img").width()/2-50;$("img").imgAreaSelect({onSelectChange:showaddnote,x1:b,y1:a,x2:b+100,y2:a+100})});$("#response").click(function(){$(this).fadeOut();return!1});$("#NoteNote").keydown(function(a){if(37==a.keyCode)return!1;
if(27==a.keyCode)return $("img").imgAreaSelect({hide:!0}),$("#noteform").fadeOut(200),!1;if(39==a.keyCode)return!1});$("#NoteAddForm").submit(function(a){$("#finished").fadeOut(200,function(){$("#finished").remove()});a.preventDefault();$("#NoteAddForm button").fadeTo(300,0.5).attr("disabled","disabled");$("#response:visible")||$("#response").fadeOut(300);$.ajax({type:"POST",url:this.action,data:$(this).serialize(),complete:function(a){$("#NoteAddForm button").fadeTo(300,1).removeAttr("disabled");
202==a.status?($("#artwork").append(a.responseText),$("img").imgAreaSelect({hide:!0}),$("#noteform").fadeOut(200,function(){$("#NoteNote").val("");$("#NoteAuthor,#NoteEmail,#response").hide();$("#finished").fadeIn(200,function(){$("#finished").delay(3E3).fadeOut(600)})})):$("#response").html(a.responseText).show()}})});$(".annotate").fadeIn(400)});var imgHeight=$("#artwork").height(),imgWidth=$("#artwork").width();
function showaddnote(a,b){imgOffset=$(a).offset();tipHeight=$("#noteform").height();form_left=parseInt(imgOffset.left)+parseInt(b.x1);b.y1>imgHeight/2?(form_top=parseInt(imgOffset.top)+parseInt(b.y1)-(tipHeight+10),$("#noteform").addClass("top")):(b.height>imgHeight/2?(form_top=parseInt(imgOffset.top)+(parseInt(b.y1)+10),form_left=parseInt(imgOffset.left)+parseInt(b.x1)+10):form_top=parseInt(imgOffset.top)+parseInt(b.y1)+parseInt(b.height)+5,$("#noteform").removeClass("top"));b.x1>imgWidth/2?(form_left=
parseInt(imgOffset.left)+parseInt(b.x1)+(b.width-300),$("#noteform").addClass("right")):$("#noteform").removeClass("right");$("#noteform").css({left:form_left+"px",top:form_top+"px"});$("#noteform").fadeIn(400);$("#noteform").css("z-index",1E4);$("#NoteX1").val(b.x1);$("#NoteY1").val(b.y1);$("#NoteHeight").val(b.height);$("#NoteWidth").val(b.width)}
(function(a,b){function c(){l=a.now();k=k||b(d,10)}function d(){a.now()-l<a.resizestop.threshold?k=b(d,10):(clearTimeout(k),k=l=0,f.width=g.width(),f.height=g.height(),h.trigger("resizestop"))}var g=a(window),h=a([]),l=0,k=0,f={};a.resizestop={propagate:!1,threshold:500};a.event.special.resizestop={setup:function(a,b){h=h.not(this);h=h.add(this);1===h.length&&g.bind("resize",c)},teardown:function(a){h=h.not(this);h.length||g.unbind("resize",c)},add:function(b){var c=b.handler;b.handler=function(b){a.resizestop.propagate||
b.stopPropagation();b.data=b.data||{};b.data.size=b.data.size||{};a.extend(b.data.size,f);return c.apply(this,arguments)}}}})(jQuery,setTimeout);$(window).bind("resizestop",function(a){$(".note").each(function(){$(this).remove()});$(".notep").each(function(){$(this).remove()});$("img").imgNotes()});